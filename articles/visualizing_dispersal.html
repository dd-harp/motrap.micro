<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="motrap.micro">
<title>Visualizing Micro-Dispersal â€¢ motrap.micro</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualizing Micro-Dispersal">
<meta property="og:description" content="motrap.micro">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">motrap.micro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/point_sets.html">Making Point Sets</a>
    <a class="dropdown-item" href="../articles/visualizing_dispersal.html">Visualizing Micro-Dispersal</a>
    <a class="dropdown-item" href="../articles/basic_dispersal.html">On Dispersal Matrices</a>
    <a class="dropdown-item" href="../articles/simulation.html">Simulation</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dd-harp/motrap.micro/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Visualizing Micro-Dispersal</h1>
            
      
      
      <div class="d-none name"><code>visualizing_dispersal.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridisLite/" class="external-link">viridisLite</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dd-harp.github.io/motrap.micro/">motrap.micro</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In behavioral state micro-simulation, mosquito movement is defined by
a <em>search</em> for a resource, and all resources are located at
points in space, <span class="math inline">\((x,y).\)</span>
Micro-dispersal is defined herein as dispersal among point sets
representing the locations of resources.</p>
<p>Micro-dispersal models in this software implementation follow a
common notation:</p>
<ul>
<li><p>A search originates in one point set, <span class="math inline">\(P_v\)</span>, with <span class="math inline">\(|v|\)</span> locations; and the destination is
another, <span class="math inline">\(P_w\)</span> with <span class="math inline">\(|w|\)</span> locations.</p></li>
<li><p>A dispersal model is instantiated as a matrix <span class="math inline">\(M_{w \leftarrow v},\)</span> where the element
<span class="math inline">\(M_{i,j} \in M\)</span> is the fraction of
mosquitoes moving from <span class="math inline">\((x_j, y_j) \in
P_v\)</span> to <span class="math inline">\((x_i, y_i) \in
P_w\)</span>.</p></li>
<li>
<p>If we had a vector, <span class="math inline">\(m_v\)</span>, of
mosquito abundances at the origin of a search, and if we want to compute
a vector, <span class="math inline">\(m_w\)</span>, describing the
number arriving at a destination, then we write <span class="math display">\[m_w = M \cdot m_v,\]</span> where</p>
<ul>
<li><p><span class="math inline">\(\mbox{dim}(M) = |w| \times
|v|,\)</span></p></li>
<li><p>and <span class="math inline">\(|m_v| = |v|,\)</span></p></li>
<li><p>so <span class="math inline">\(|m_w| = |w|.\)</span></p></li>
</ul>
</li>
</ul>
<p>By convention, we constrain model so that, <span class="math display">\[\sum_i M_{i,j}=1.\]</span></p>
<p>If we want to model failed dispersal, then we will often want to
handle the case where the origin and destination are the same point
set.</p>
<p>In the following, we discuss the challenge of visualizing
micro-dispersal matrices using functions in <code>motrap.micro</code>
where either <span class="math inline">\(P_v \neq P_w\)</span> or where
<span class="math inline">\(P_v = P_w.\)</span></p>
</div>
<div class="section level2">
<h2 id="dispersal-from-p_v-neq-p_w">Dispersal from <span class="math inline">\(P_v \neq
P_w\)</span><a class="anchor" aria-label="anchor" href="#dispersal-from-p_v-neq-p_w"></a>
</h2>
<p>To illustrate, we generate two point sets:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nPv</span> <span class="op">=</span> <span class="fl">37</span> </span>
<span><span class="va">nPw</span> <span class="op">=</span> <span class="fl">73</span> </span>
<span><span class="va">dd</span> <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="va">Pv</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nPv</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span>
<span><span class="va">Pw</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nPw</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span></code></pre></div>
<p>Now, we can define a dispersal matrix from <span class="math inline">\(P_v\)</span> to <span class="math inline">\(P_w\)</span>, and <em>vice versa</em>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">M_wv</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_Psi_xy.html">make_Psi_xy</a></span><span class="op">(</span><span class="va">Pv</span>, <span class="va">Pw</span>, <span class="fu"><a href="../reference/make_kF_exp.html">make_kF_exp</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">M_vw</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_Psi_xy.html">make_Psi_xy</a></span><span class="op">(</span><span class="va">Pw</span>, <span class="va">Pv</span>, <span class="fu"><a href="../reference/make_kF_exp.html">make_kF_exp</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The generic function <code>plot_matrix_xy</code> was developed to
plot dispersal from <span class="math inline">\(P_v\)</span> to <span class="math inline">\(P_w.\)</span></p>
<p><img src="visualizing_dispersal_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="movement">Movement<a class="anchor" aria-label="anchor" href="#movement"></a>
</h2>
<p>Because of the arrangement of points, some points in <span class="math inline">\(P_w\)</span> get more mosquitoes. If an equal
number of mosquitoes left every point in <span class="math inline">\(P_v\)</span>, the number arriving at each point in
<span class="math inline">\(P_w\)</span> can be found by summing the
rows of the dispersal matrix, <span class="math inline">\(M\)</span>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">M_wv</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Mosquito Density at Destination"</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">M</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">j</span>,<span class="va">i</span><span class="op">)</span><span class="op">]</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualizing_dispersal_files/figure-html/unnamed-chunk-6-1.png" width="480"></p>
<p>The matrix <span class="math inline">\(M\)</span> has
<code>nPv</code><span class="math inline">\(=29
\times\)</span><code>nPw</code><span class="math inline">\(=43\)</span>
elements, for a total of <span class="math inline">\(1,161\)</span>.
This is a reasonably small number of points to consider, but what if we
increased the number of points in each set by a factor of 10 or 100? The
size of the objects can grow quite large quite quickly.</p>
<p>We assume that mosquitoes are more likely to move to nearby sites.
The fraction going to each site is highly uneven. The model computes a
probability of moving between each pair of points, but <em>most</em> of
the elements fractions are very small.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">M_wv</span><span class="op">)</span>, <span class="fl">40</span>, xaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">5</span><span class="op">:</span><span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span>, <span class="st">"0.001"</span>, <span class="st">"0.01"</span>, <span class="st">"0.1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">50</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualizing_dispersal_files/figure-html/unnamed-chunk-7-1.png" width="480"></p>
<p>In the following, we draw an arrow from the points in the starting
set (<span class="math inline">\(P_v\)</span>, salmon) to the points in
the destination set (<span class="math inline">\(P_w\)</span>,
lightblue). On the left, all the edges were plotted, but on the right,
edges were plotted only if the destination got more than 1% of the
dispersing mosquitoes. We vary the size of the destination point to be
the density of mosquitoes arriving:</p>
<p><img src="visualizing_dispersal_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<p>In the top, we plot all the dispersal fractions for all the points in
order, and we added a dark blue dot at the point where we stopped
plotting.</p>
<p>Another way to set a cutoff is to compute the empirical cdf (the
cumulati e sum of the top graph) and plot 90% of the total mass (the
dark red dot in the bottom).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ot</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">M_wv</span><span class="op">)</span>, decreasing<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">Mo</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">M_wv</span><span class="op">)</span><span class="op">[</span><span class="va">ot</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Mo</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylab <span class="op">=</span> <span class="st">"PMF"</span>, xlab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">ix1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">Mo</span><span class="op">&gt;</span><span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ix1</span>, <span class="va">Mo</span><span class="op">[</span><span class="va">ix1</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">15</span>, col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ecdf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">Mo</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">M_wv</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ecdf</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">"eCMF"</span><span class="op">)</span></span>
<span><span class="va">ix2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">ecdf</span> <span class="op">&gt;</span><span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ix2</span>, <span class="va">ecdf</span><span class="op">[</span><span class="va">ix2</span><span class="op">]</span>, pch<span class="op">=</span><span class="fl">19</span>, col <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span></code></pre></div>
<p><img src="visualizing_dispersal_files/figure-html/unnamed-chunk-9-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="self">Self<a class="anchor" aria-label="anchor" href="#self"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Mvv</span> <span class="op">=</span> <span class="va">M_vw</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">M_wv</span></span>
<span><span class="va">Mww</span> <span class="op">=</span> <span class="va">M_wv</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">M_vw</span></span></code></pre></div>
<p><img src="visualizing_dispersal_files/figure-html/unnamed-chunk-11-1.png" width="768"></p>
</div>
<div class="section level2">
<h2 id="plot-size">Plot Size<a class="anchor" aria-label="anchor" href="#plot-size"></a>
</h2>
<p>We can now ask a practical question â€“ how many edges would we plot if
the system was much larger:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nEdges</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">nS</span>, <span class="va">nD</span>, <span class="va">frac</span><span class="op">=</span><span class="fl">0.01</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">dd</span> <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="va">S</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nS</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span>
<span>  <span class="va">D</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nD</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span>
<span>  <span class="va">M</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_Psi_xy.html">make_Psi_xy</a></span><span class="op">(</span><span class="va">S</span>, <span class="va">D</span>, <span class="fu"><a href="../reference/make_kF_exp.html">make_kF_exp</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">ot</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>, decreasing<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="va">Mo</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">[</span><span class="va">ot</span><span class="op">]</span></span>
<span>  <span class="va">ix1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">Mo</span><span class="op">&gt;</span><span class="va">frac</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ix1</span>, <span class="va">nS</span><span class="op">*</span><span class="va">nD</span>, <span class="va">ix1</span><span class="op">/</span><span class="va">nS</span><span class="op">/</span><span class="va">nD</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>If we generated 20 models that were statistically indistinguishable
from the one above, we can compute the average number of edges plotted,
and the average fraction of edges showing.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fu">nEdges</span><span class="op">(</span><span class="fl">27</span>, <span class="fl">43</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">out</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>nEdges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## nEdges </span></span>
<span><span class="co">## 385.05</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>fracEdges <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## fracEdges </span></span>
<span><span class="co">## 0.3316537</span></span></code></pre>
<p>If we start with ten times as many source and destination point, we
end up plotting about 20 times as many points:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fu">nEdges</span><span class="op">(</span><span class="fl">270</span>, <span class="fl">430</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">out</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>nEdges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  nEdges </span></span>
<span><span class="co">## 7709.45</span></span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>fracEdges <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  fracEdges </span></span>
<span><span class="co">## 0.06640353</span></span></code></pre>
<p>The plot is much busier to look at, but it renders in a reasonable
amount of time:</p>
<p><strong>This code was not run because it creates and stores an object
that is bigger than we wanted to store on github. Try running this code
on your computer and see what happens?</strong></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nPv</span> <span class="op">=</span> <span class="fl">270</span> </span>
<span><span class="va">nPw</span> <span class="op">=</span> <span class="fl">430</span> </span>
<span><span class="va">dd</span><span class="op">=</span><span class="fl">10</span></span>
<span><span class="va">Pv</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nPv</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span>
<span><span class="va">Pw</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nPw</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span>
<span><span class="va">M</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_Psi_xy.html">make_Psi_xy</a></span><span class="op">(</span><span class="va">Pv</span>, <span class="va">Pw</span>, <span class="fu"><a href="../reference/make_kF_exp.html">make_kF_exp</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_matrix_xy.html">plot_matrix_xy</a></span><span class="op">(</span><span class="va">Pv</span>, <span class="va">Pw</span>, <span class="va">M</span>, min_edge_frac <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span> </span></code></pre></div>
<p>If we plotted 50 times as many of each, now something suprising
happens:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fu">nEdges</span><span class="op">(</span><span class="fl">270</span><span class="op">*</span><span class="fl">5</span>, <span class="fl">430</span><span class="op">*</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">out</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>nEdges <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## nEdges </span></span>
<span><span class="co">## 2434.3</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>fracEdges <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">out</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    fracEdges </span></span>
<span><span class="co">## 0.0008386908</span></span></code></pre>
<p>We end up plotting fewer edges. Whatâ€™s happening?</p>
<p><strong>This code was not run because it creates and stores an object
that is bigger than we wanted to store on github. Try running this code
on your computer and see what happens?</strong></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nPv</span> <span class="op">=</span> <span class="fl">270</span><span class="op">*</span><span class="fl">5</span> </span>
<span><span class="va">nPw</span> <span class="op">=</span> <span class="fl">430</span><span class="op">*</span><span class="fl">5</span> </span>
<span><span class="va">dd</span><span class="op">=</span><span class="fl">10</span></span>
<span><span class="va">Pv</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nPv</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span>
<span><span class="va">Pw</span> <span class="op">=</span> <span class="fu"><a href="../reference/unif_xy.html">unif_xy</a></span><span class="op">(</span><span class="va">nPw</span>,<span class="op">-</span><span class="va">dd</span>, <span class="va">dd</span><span class="op">)</span> </span>
<span><span class="va">M</span> <span class="op">=</span> <span class="fu"><a href="../reference/make_Psi_xy.html">make_Psi_xy</a></span><span class="op">(</span><span class="va">Pv</span>, <span class="va">Pw</span>, <span class="fu"><a href="../reference/make_kF_exp.html">make_kF_exp</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_matrix_xy.html">plot_matrix_xy</a></span><span class="op">(</span><span class="va">Pv</span>, <span class="va">Pw</span>, <span class="va">M</span>, min_edge_frac <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> </span></code></pre></div>
<p>The visualization is emphasizing the weights of points in the corner,
which have fewer neighbors than points near the center. The result is a
figure that illustrates both the importance of being able to visualize a
model, and the importance of understanding how this approach highlights
real and serious questions about mosquito dispersal â€“ what happens at
the edges of habitats?</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by David L. Smith, HÃ©ctor M. SÃ¡nchez C.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
